{"version":3,"names":["_localStorage","require","_indexedDB","StorageAdapter","constructor","options","config","preferredStorage","dbName","version","quotaWarningThreshold","debug","primaryAdapter","fallbackAdapter","isInitialized","init","isIndexedDBSupported","IndexedDBAdapter","LocalStorageAdapter","log","checkStorageQuota","error","console","Error","window","indexedDB","undefined","e","navigator","storage","estimate","used","usage","total","quota","formatBytes","warn","percentage","bytes","k","sizes","i","Math","floor","parseFloat","pow","toFixed","setItem","key","value","ensureInitialized","fallbackError","getItem","syncError","message","removeItem","promises","push","catch","Promise","all","clear","keys","size","args","getAdapterInfo","primary","name","fallback","exports","GameStorage","storageAdapter","saveSettings","settings","getSettings","defaultSettings","soundEnabled","vibrationEnabled","effectsEnabled","theme","saveHighScore","mode","score","tps","record","timestamp","Date","now","date","toISOString","getHighScore","saveGameHistory","gameData","history","getGameHistory","unshift","id","length","splice","clearGameData","gameKeys","filter","startsWith","gameStorage"],"sources":["adapter.js"],"sourcesContent":["/**\n * 統一儲存適配器 - Storage Adapter\n * 提供 LocalStorage 與 IndexedDB 的統一介面\n * 基於適配器模式設計，支援自動回退與容量管理\n * \n * @author haotool\n * @version 7.2.3\n * @created 2025-08-18T02:39:58+08:00\n */\n\nimport { LocalStorageAdapter } from './localStorage.js';\nimport { IndexedDBAdapter } from './indexedDB.js';\n\n/**\n * 儲存適配器主類別\n * 自動選擇最佳的儲存方案並提供統一API\n */\nexport class StorageAdapter {\n  constructor(options = {}) {\n    this.config = {\n      // 預設使用 IndexedDB，回退到 LocalStorage\n      preferredStorage: 'indexeddb',\n      // 資料庫名稱\n      dbName: options.dbName || 'Bunny ClickDB',\n      // 版本號\n      version: options.version || 1,\n      // 容量警告閾值 (5MB)\n      quotaWarningThreshold: options.quotaWarningThreshold || 5 * 1024 * 1024,\n      // 是否啟用調試模式\n      debug: options.debug || false,\n      ...options\n    };\n\n    this.primaryAdapter = null;\n    this.fallbackAdapter = null;\n    this.isInitialized = false;\n\n    this.init();\n  }\n\n  /**\n   * 初始化適配器\n   */\n  async init() {\n    try {\n      // 檢測 IndexedDB 支援性\n      if (this.config.preferredStorage === 'indexeddb' && this.isIndexedDBSupported()) {\n        this.primaryAdapter = new IndexedDBAdapter(this.config);\n        this.fallbackAdapter = new LocalStorageAdapter(this.config);\n        \n        await this.primaryAdapter.init();\n        this.log('✅ IndexedDB 初始化成功，LocalStorage 作為後備');\n      } else {\n        // 直接使用 LocalStorage\n        this.primaryAdapter = new LocalStorageAdapter(this.config);\n        this.log('📝 使用 LocalStorage 作為主要儲存');\n      }\n\n      await this.primaryAdapter.init();\n      this.isInitialized = true;\n      \n      // 檢查儲存配額\n      await this.checkStorageQuota();\n      \n    } catch (error) {\n      console.error('❌ 儲存適配器初始化失敗:', error);\n      \n      // 回退到 LocalStorage\n      if (this.fallbackAdapter) {\n        this.log('🔄 回退到 LocalStorage');\n        this.primaryAdapter = this.fallbackAdapter;\n        await this.primaryAdapter.init();\n        this.isInitialized = true;\n      } else {\n        throw new Error('所有儲存選項均不可用');\n      }\n    }\n  }\n\n  /**\n   * 檢測 IndexedDB 支援性\n   */\n  isIndexedDBSupported() {\n    try {\n      return 'indexedDB' in window && \n             window.indexedDB !== null && \n             window.indexedDB !== undefined;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  /**\n   * 檢查儲存配額\n   */\n  async checkStorageQuota() {\n    try {\n      if ('storage' in navigator && 'estimate' in navigator.storage) {\n        const estimate = await navigator.storage.estimate();\n        const used = estimate.usage || 0;\n        const total = estimate.quota || 0;\n        \n        this.log(`📊 儲存使用狀況: ${this.formatBytes(used)} / ${this.formatBytes(total)}`);\n        \n        if (used > this.config.quotaWarningThreshold) {\n          console.warn(`⚠️ 儲存空間使用量較高: ${this.formatBytes(used)}`);\n        }\n        \n        return { used, total, percentage: total > 0 ? (used / total) * 100 : 0 };\n      }\n    } catch (error) {\n      this.log('⚠️ 無法檢查儲存配額:', error);\n    }\n    return null;\n  }\n\n  /**\n   * 格式化位元組大小\n   */\n  formatBytes(bytes) {\n    if (bytes === 0) return '0 Bytes';\n    const k = 1024;\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n  }\n\n  /**\n   * 儲存資料\n   */\n  async setItem(key, value, options = {}) {\n    await this.ensureInitialized();\n    \n    try {\n      await this.primaryAdapter.setItem(key, value, options);\n      this.log(`💾 儲存成功: ${key}`);\n    } catch (error) {\n      console.error(`❌ 儲存失敗 ${key}:`, error);\n      \n      // 嘗試使用後備適配器\n      if (this.fallbackAdapter && this.primaryAdapter !== this.fallbackAdapter) {\n        try {\n          await this.fallbackAdapter.setItem(key, value, options);\n          this.log(`💾 後備儲存成功: ${key}`);\n        } catch (fallbackError) {\n          console.error(`❌ 後備儲存也失敗 ${key}:`, fallbackError);\n          throw fallbackError;\n        }\n      } else {\n        throw error;\n      }\n    }\n  }\n\n  /**\n   * 讀取資料\n   */\n  async getItem(key) {\n    await this.ensureInitialized();\n    \n    try {\n      const value = await this.primaryAdapter.getItem(key);\n      if (value !== null) {\n        this.log(`📖 讀取成功: ${key}`);\n        return value;\n      }\n    } catch (error) {\n      console.error(`❌ 讀取失敗 ${key}:`, error);\n    }\n\n    // 嘗試從後備適配器讀取\n    if (this.fallbackAdapter && this.primaryAdapter !== this.fallbackAdapter) {\n      try {\n        const value = await this.fallbackAdapter.getItem(key);\n        if (value !== null) {\n          this.log(`📖 後備讀取成功: ${key}`);\n          // 同步到主適配器\n          try {\n            await this.primaryAdapter.setItem(key, value);\n          } catch (syncError) {\n            this.log(`⚠️ 同步到主適配器失敗: ${syncError.message}`);\n          }\n          return value;\n        }\n      } catch (fallbackError) {\n        console.error(`❌ 後備讀取也失敗 ${key}:`, fallbackError);\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * 移除資料\n   */\n  async removeItem(key) {\n    await this.ensureInitialized();\n    \n    const promises = [];\n    \n    // 從主適配器移除\n    promises.push(\n      this.primaryAdapter.removeItem(key).catch(error => {\n        console.error(`❌ 主適配器移除失敗 ${key}:`, error);\n      })\n    );\n\n    // 從後備適配器移除\n    if (this.fallbackAdapter && this.primaryAdapter !== this.fallbackAdapter) {\n      promises.push(\n        this.fallbackAdapter.removeItem(key).catch(error => {\n          console.error(`❌ 後備適配器移除失敗 ${key}:`, error);\n        })\n      );\n    }\n\n    await Promise.all(promises);\n    this.log(`🗑️ 移除完成: ${key}`);\n  }\n\n  /**\n   * 清空所有資料\n   */\n  async clear() {\n    await this.ensureInitialized();\n    \n    const promises = [];\n    \n    promises.push(\n      this.primaryAdapter.clear().catch(error => {\n        console.error('❌ 主適配器清空失敗:', error);\n      })\n    );\n\n    if (this.fallbackAdapter && this.primaryAdapter !== this.fallbackAdapter) {\n      promises.push(\n        this.fallbackAdapter.clear().catch(error => {\n          console.error('❌ 後備適配器清空失敗:', error);\n        })\n      );\n    }\n\n    await Promise.all(promises);\n    this.log('🧹 儲存清空完成');\n  }\n\n  /**\n   * 獲取所有鍵名\n   */\n  async keys() {\n    await this.ensureInitialized();\n    return await this.primaryAdapter.keys();\n  }\n\n  /**\n   * 獲取儲存大小\n   */\n  async size() {\n    await this.ensureInitialized();\n    return await this.primaryAdapter.size();\n  }\n\n  /**\n   * 確保適配器已初始化\n   */\n  async ensureInitialized() {\n    if (!this.isInitialized) {\n      await this.init();\n    }\n  }\n\n  /**\n   * 調試日誌\n   */\n  log(...args) {\n    if (this.config.debug) {\n      console.log('🗃️ StorageAdapter:', ...args);\n    }\n  }\n\n  /**\n   * 獲取適配器資訊\n   */\n  getAdapterInfo() {\n    return {\n      primary: this.primaryAdapter?.constructor.name || 'None',\n      fallback: this.fallbackAdapter?.constructor.name || 'None',\n      isInitialized: this.isInitialized,\n      config: this.config\n    };\n  }\n}\n\n// 建立預設實例\nexport const storage = new StorageAdapter({\n  debug: false, // 生產環境關閉調試\n  dbName: 'Bunny ClickDB',\n  version: 1\n});\n\n// 遊戲專用的高階 API\nexport class GameStorage {\n  constructor(storageAdapter = storage) {\n    this.storage = storageAdapter;\n  }\n\n  // 儲存遊戲設定\n  async saveSettings(settings) {\n    await this.storage.setItem('game:settings', settings);\n  }\n\n  // 讀取遊戲設定\n  async getSettings() {\n    const defaultSettings = {\n      soundEnabled: true,\n      vibrationEnabled: true,\n      effectsEnabled: true,\n      theme: 'auto'\n    };\n    \n    const settings = await this.storage.getItem('game:settings');\n    return settings ? { ...defaultSettings, ...settings } : defaultSettings;\n  }\n\n  // 儲存最高分\n  async saveHighScore(mode, score, tps) {\n    const key = `game:highscore:${mode}`;\n    const record = {\n      score,\n      tps,\n      timestamp: Date.now(),\n      date: new Date().toISOString()\n    };\n    \n    await this.storage.setItem(key, record);\n  }\n\n  // 獲取最高分\n  async getHighScore(mode) {\n    const key = `game:highscore:${mode}`;\n    return await this.storage.getItem(key);\n  }\n\n  // 儲存遊戲歷史\n  async saveGameHistory(gameData) {\n    const history = await this.getGameHistory();\n    history.unshift({\n      ...gameData,\n      id: Date.now(),\n      timestamp: Date.now()\n    });\n    \n    // 保留最近 100 筆記錄\n    if (history.length > 100) {\n      history.splice(100);\n    }\n    \n    await this.storage.setItem('game:history', history);\n  }\n\n  // 獲取遊戲歷史\n  async getGameHistory() {\n    return await this.storage.getItem('game:history') || [];\n  }\n\n  // 清空遊戲資料\n  async clearGameData() {\n    const keys = await this.storage.keys();\n    const gameKeys = keys.filter(key => key.startsWith('game:'));\n    \n    for (const key of gameKeys) {\n      await this.storage.removeItem(key);\n    }\n  }\n}\n\n// 建立遊戲儲存實例\nexport const gameStorage = new GameStorage();\n"],"mappings":"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","ignoreList":[]}