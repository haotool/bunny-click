345924987c0996e2761280b666cf7104
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.LocalStorageAdapter = void 0;
/**
 * LocalStorage 適配器
 * 提供標準化的 LocalStorage 介面
 *
 * @author haotool
 * @version 7.2.3
 * @created 2025-08-18T02:39:58+08:00
 */

class LocalStorageAdapter {
  constructor(config = {}) {
    this.config = config;
    this.prefix = config.dbName ? `${config.dbName}:` : 'bunny-click:';
    this.isAvailable = this.checkAvailability();
  }

  /**
   * 檢查 LocalStorage 可用性
   */
  checkAvailability() {
    try {
      const testKey = '__storage_test__';
      localStorage.setItem(testKey, 'test');
      localStorage.removeItem(testKey);
      return true;
    } catch (e) {
      console.warn('⚠️ LocalStorage 不可用:', e);
      return false;
    }
  }

  /**
   * 初始化
   */
  async init() {
    if (!this.isAvailable) {
      throw new Error('LocalStorage 不可用');
    }

    // 清理過期資料
    await this.cleanupExpiredData();
    this.log('✅ LocalStorage 適配器初始化完成');
  }

  /**
   * 清理過期資料
   */
  async cleanupExpiredData() {
    try {
      const keys = Object.keys(localStorage);
      const prefixedKeys = keys.filter(key => key.startsWith(this.prefix));
      for (const key of prefixedKeys) {
        try {
          const data = JSON.parse(localStorage.getItem(key));

          // 檢查是否有過期時間且已過期
          if (data && data.__expires && Date.now() > data.__expires) {
            localStorage.removeItem(key);
            this.log(`🧹 清理過期資料: ${key}`);
          }
        } catch (parseError) {
          // 如果解析失敗，可能是舊格式資料，保留不動
          this.log(`⚠️ 跳過無法解析的資料: ${key}`);
        }
      }
    } catch (error) {
      this.log('⚠️ 清理過期資料時發生錯誤:', error);
    }
  }

  /**
   * 生成完整鍵名
   */
  getFullKey(key) {
    return `${this.prefix}${key}`;
  }

  /**
   * 儲存資料
   */
  async setItem(key, value, options = {}) {
    if (!this.isAvailable) {
      throw new Error('LocalStorage 不可用');
    }
    try {
      const fullKey = this.getFullKey(key);

      // 包裝資料，添加元資訊
      const wrappedData = {
        value,
        __timestamp: Date.now(),
        __version: this.config.version || 1
      };

      // 添加過期時間 (如果指定)
      if (options.ttl) {
        wrappedData.__expires = Date.now() + options.ttl;
      }
      const serializedData = JSON.stringify(wrappedData);

      // 檢查大小限制 (LocalStorage 通常限制為 5-10MB)
      if (serializedData.length > 5 * 1024 * 1024) {
        throw new Error('資料過大，超出 LocalStorage 限制');
      }
      localStorage.setItem(fullKey, serializedData);
      this.log(`💾 LocalStorage 儲存: ${key} (${this.formatBytes(serializedData.length)})`);
    } catch (error) {
      if (error.name === 'QuotaExceededError' || error.name === 'NS_ERROR_DOM_QUOTA_REACHED') {
        // 配額超出，嘗試清理舊資料
        await this.cleanupOldData();

        // 再次嘗試儲存
        try {
          const fullKey = this.getFullKey(key);
          const wrappedData = {
            value,
            __timestamp: Date.now()
          };
          localStorage.setItem(fullKey, JSON.stringify(wrappedData));
          this.log(`💾 LocalStorage 儲存 (清理後): ${key}`);
        } catch (retryError) {
          throw new Error(`LocalStorage 配額已滿且清理後仍無法儲存: ${retryError.message}`);
        }
      } else {
        throw error;
      }
    }
  }

  /**
   * 讀取資料
   */
  async getItem(key) {
    if (!this.isAvailable) {
      throw new Error('LocalStorage 不可用');
    }
    try {
      const fullKey = this.getFullKey(key);
      const serializedData = localStorage.getItem(fullKey);
      if (serializedData === null) {
        return null;
      }
      const wrappedData = JSON.parse(serializedData);

      // 檢查是否過期
      if (wrappedData.__expires && Date.now() > wrappedData.__expires) {
        localStorage.removeItem(fullKey);
        this.log(`⏰ 資料已過期並移除: ${key}`);
        return null;
      }

      // 相容性處理：如果沒有包裝結構，直接返回原始資料
      if (wrappedData.hasOwnProperty('value')) {
        this.log(`📖 LocalStorage 讀取: ${key}`);
        return wrappedData.value;
      } else {
        // 舊格式資料
        this.log(`📖 LocalStorage 讀取 (舊格式): ${key}`);
        return wrappedData;
      }
    } catch (error) {
      console.error(`❌ LocalStorage 讀取失敗 ${key}:`, error);
      return null;
    }
  }

  /**
   * 移除資料
   */
  async removeItem(key) {
    if (!this.isAvailable) {
      throw new Error('LocalStorage 不可用');
    }
    const fullKey = this.getFullKey(key);
    localStorage.removeItem(fullKey);
    this.log(`🗑️ LocalStorage 移除: ${key}`);
  }

  /**
   * 清空所有資料
   */
  async clear() {
    if (!this.isAvailable) {
      throw new Error('LocalStorage 不可用');
    }
    const keys = Object.keys(localStorage);
    const prefixedKeys = keys.filter(key => key.startsWith(this.prefix));
    for (const key of prefixedKeys) {
      localStorage.removeItem(key);
    }
    this.log(`🧹 LocalStorage 清空: ${prefixedKeys.length} 項目`);
  }

  /**
   * 獲取所有鍵名
   */
  async keys() {
    if (!this.isAvailable) {
      throw new Error('LocalStorage 不可用');
    }
    const keys = Object.keys(localStorage);
    return keys.filter(key => key.startsWith(this.prefix)).map(key => key.substring(this.prefix.length));
  }

  /**
   * 獲取儲存項目數量
   */
  async size() {
    const keys = await this.keys();
    return keys.length;
  }

  /**
   * 清理舊資料 (當配額不足時)
   */
  async cleanupOldData() {
    try {
      const keys = Object.keys(localStorage);
      const prefixedKeys = keys.filter(key => key.startsWith(this.prefix));

      // 獲取所有資料的時間戳記
      const dataWithTimestamp = [];
      for (const key of prefixedKeys) {
        try {
          const data = JSON.parse(localStorage.getItem(key));
          const timestamp = data.__timestamp || 0;
          dataWithTimestamp.push({
            key,
            timestamp
          });
        } catch (e) {
          // 無法解析的資料視為最舊
          dataWithTimestamp.push({
            key,
            timestamp: 0
          });
        }
      }

      // 按時間戳記排序，移除最舊的 25% 資料
      dataWithTimestamp.sort((a, b) => a.timestamp - b.timestamp);
      const itemsToRemove = Math.ceil(dataWithTimestamp.length * 0.25);
      for (let i = 0; i < itemsToRemove; i++) {
        localStorage.removeItem(dataWithTimestamp[i].key);
        this.log(`🧹 清理舊資料: ${dataWithTimestamp[i].key}`);
      }
      this.log(`🧹 清理完成，移除 ${itemsToRemove} 項舊資料`);
    } catch (error) {
      this.log('⚠️ 清理舊資料時發生錯誤:', error);
    }
  }

  /**
   * 格式化位元組大小
   */
  formatBytes(bytes) {
    if (bytes === 0) {
      return '0 Bytes';
    }
    const k = 1024;
    const sizes = ['Bytes', 'KB', 'MB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return `${parseFloat((bytes / Math.pow(k, i)).toFixed(2))} ${sizes[i]}`;
  }

  /**
   * 調試日誌
   */
  log(...args) {
    if (this.config.debug) {
      console.log('📝 LocalStorageAdapter:', ...args);
    }
  }

  /**
   * 獲取使用統計
   */
  async getStats() {
    try {
      const keys = await this.keys();
      let totalSize = 0;
      for (const key of keys) {
        const fullKey = this.getFullKey(key);
        const data = localStorage.getItem(fullKey);
        if (data) {
          totalSize += data.length * 2; // UTF-16 字符佔 2 位元組
        }
      }
      return {
        itemCount: keys.length,
        totalSize,
        formattedSize: this.formatBytes(totalSize),
        maxSize: 5 * 1024 * 1024,
        // 5MB 估計值
        usagePercentage: totalSize / (5 * 1024 * 1024) * 100
      };
    } catch (error) {
      this.log('⚠️ 獲取統計資訊時發生錯誤:', error);
      return null;
    }
  }
}
exports.LocalStorageAdapter = LocalStorageAdapter;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJMb2NhbFN0b3JhZ2VBZGFwdGVyIiwiY29uc3RydWN0b3IiLCJjb25maWciLCJwcmVmaXgiLCJkYk5hbWUiLCJpc0F2YWlsYWJsZSIsImNoZWNrQXZhaWxhYmlsaXR5IiwidGVzdEtleSIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJyZW1vdmVJdGVtIiwiZSIsImNvbnNvbGUiLCJ3YXJuIiwiaW5pdCIsIkVycm9yIiwiY2xlYW51cEV4cGlyZWREYXRhIiwibG9nIiwia2V5cyIsIk9iamVjdCIsInByZWZpeGVkS2V5cyIsImZpbHRlciIsImtleSIsInN0YXJ0c1dpdGgiLCJkYXRhIiwiSlNPTiIsInBhcnNlIiwiZ2V0SXRlbSIsIl9fZXhwaXJlcyIsIkRhdGUiLCJub3ciLCJwYXJzZUVycm9yIiwiZXJyb3IiLCJnZXRGdWxsS2V5IiwidmFsdWUiLCJvcHRpb25zIiwiZnVsbEtleSIsIndyYXBwZWREYXRhIiwiX190aW1lc3RhbXAiLCJfX3ZlcnNpb24iLCJ2ZXJzaW9uIiwidHRsIiwic2VyaWFsaXplZERhdGEiLCJzdHJpbmdpZnkiLCJsZW5ndGgiLCJmb3JtYXRCeXRlcyIsIm5hbWUiLCJjbGVhbnVwT2xkRGF0YSIsInJldHJ5RXJyb3IiLCJtZXNzYWdlIiwiaGFzT3duUHJvcGVydHkiLCJjbGVhciIsIm1hcCIsInN1YnN0cmluZyIsInNpemUiLCJkYXRhV2l0aFRpbWVzdGFtcCIsInRpbWVzdGFtcCIsInB1c2giLCJzb3J0IiwiYSIsImIiLCJpdGVtc1RvUmVtb3ZlIiwiTWF0aCIsImNlaWwiLCJpIiwiYnl0ZXMiLCJrIiwic2l6ZXMiLCJmbG9vciIsInBhcnNlRmxvYXQiLCJwb3ciLCJ0b0ZpeGVkIiwiYXJncyIsImRlYnVnIiwiZ2V0U3RhdHMiLCJ0b3RhbFNpemUiLCJpdGVtQ291bnQiLCJmb3JtYXR0ZWRTaXplIiwibWF4U2l6ZSIsInVzYWdlUGVyY2VudGFnZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyJsb2NhbFN0b3JhZ2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBMb2NhbFN0b3JhZ2Ug6YGp6YWN5ZmoXG4gKiDmj5DkvpvmqJnmupbljJbnmoQgTG9jYWxTdG9yYWdlIOS7i+mdolxuICpcbiAqIEBhdXRob3IgaGFvdG9vbFxuICogQHZlcnNpb24gNy4yLjNcbiAqIEBjcmVhdGVkIDIwMjUtMDgtMThUMDI6Mzk6NTgrMDg6MDBcbiAqL1xuXG5leHBvcnQgY2xhc3MgTG9jYWxTdG9yYWdlQWRhcHRlciB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZyA9IHt9KSB7XG4gICAgdGhpcy5jb25maWcgPSBjb25maWc7XG4gICAgdGhpcy5wcmVmaXggPSBjb25maWcuZGJOYW1lID8gYCR7Y29uZmlnLmRiTmFtZX06YCA6ICdidW5ueS1jbGljazonO1xuICAgIHRoaXMuaXNBdmFpbGFibGUgPSB0aGlzLmNoZWNrQXZhaWxhYmlsaXR5KCk7XG4gIH1cblxuICAvKipcbiAgICog5qqi5p+lIExvY2FsU3RvcmFnZSDlj6/nlKjmgKdcbiAgICovXG4gIGNoZWNrQXZhaWxhYmlsaXR5KCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB0ZXN0S2V5ID0gJ19fc3RvcmFnZV90ZXN0X18nO1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0odGVzdEtleSwgJ3Rlc3QnKTtcbiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKHRlc3RLZXkpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgY29uc29sZS53YXJuKCfimqDvuI8gTG9jYWxTdG9yYWdlIOS4jeWPr+eUqDonLCBlKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5Yid5aeL5YyWXG4gICAqL1xuICBhc3luYyBpbml0KCkge1xuICAgIGlmICghdGhpcy5pc0F2YWlsYWJsZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdMb2NhbFN0b3JhZ2Ug5LiN5Y+v55SoJyk7XG4gICAgfVxuXG4gICAgLy8g5riF55CG6YGO5pyf6LOH5paZXG4gICAgYXdhaXQgdGhpcy5jbGVhbnVwRXhwaXJlZERhdGEoKTtcblxuICAgIHRoaXMubG9nKCfinIUgTG9jYWxTdG9yYWdlIOmBqemFjeWZqOWIneWni+WMluWujOaIkCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIOa4heeQhumBjuacn+izh+aWmVxuICAgKi9cbiAgYXN5bmMgY2xlYW51cEV4cGlyZWREYXRhKCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMobG9jYWxTdG9yYWdlKTtcbiAgICAgIGNvbnN0IHByZWZpeGVkS2V5cyA9IGtleXMuZmlsdGVyKGtleSA9PiBrZXkuc3RhcnRzV2l0aCh0aGlzLnByZWZpeCkpO1xuXG4gICAgICBmb3IgKGNvbnN0IGtleSBvZiBwcmVmaXhlZEtleXMpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpKTtcblxuICAgICAgICAgIC8vIOaqouafpeaYr+WQpuaciemBjuacn+aZgumWk+S4lOW3sumBjuacn1xuICAgICAgICAgIGlmIChkYXRhICYmIGRhdGEuX19leHBpcmVzICYmIERhdGUubm93KCkgPiBkYXRhLl9fZXhwaXJlcykge1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTtcbiAgICAgICAgICAgIHRoaXMubG9nKGDwn6e5IOa4heeQhumBjuacn+izh+aWmTogJHtrZXl9YCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XG4gICAgICAgICAgLy8g5aaC5p6c6Kej5p6Q5aSx5pWX77yM5Y+v6IO95piv6IiK5qC85byP6LOH5paZ77yM5L+d55WZ5LiN5YuVXG4gICAgICAgICAgdGhpcy5sb2coYOKaoO+4jyDot7PpgY7nhKHms5Xop6PmnpDnmoTos4fmlpk6ICR7a2V5fWApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMubG9nKCfimqDvuI8g5riF55CG6YGO5pyf6LOH5paZ5pmC55m855Sf6Yyv6KqkOicsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog55Sf5oiQ5a6M5pW06Y215ZCNXG4gICAqL1xuICBnZXRGdWxsS2V5KGtleSkge1xuICAgIHJldHVybiBgJHt0aGlzLnByZWZpeH0ke2tleX1gO1xuICB9XG5cbiAgLyoqXG4gICAqIOWEsuWtmOizh+aWmVxuICAgKi9cbiAgYXN5bmMgc2V0SXRlbShrZXksIHZhbHVlLCBvcHRpb25zID0ge30pIHtcbiAgICBpZiAoIXRoaXMuaXNBdmFpbGFibGUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTG9jYWxTdG9yYWdlIOS4jeWPr+eUqCcpO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBmdWxsS2V5ID0gdGhpcy5nZXRGdWxsS2V5KGtleSk7XG5cbiAgICAgIC8vIOWMheijneizh+aWme+8jOa3u+WKoOWFg+izh+ioilxuICAgICAgY29uc3Qgd3JhcHBlZERhdGEgPSB7XG4gICAgICAgIHZhbHVlLFxuICAgICAgICBfX3RpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgX192ZXJzaW9uOiB0aGlzLmNvbmZpZy52ZXJzaW9uIHx8IDEsXG4gICAgICB9O1xuXG4gICAgICAvLyDmt7vliqDpgY7mnJ/mmYLplpMgKOWmguaenOaMh+WumilcbiAgICAgIGlmIChvcHRpb25zLnR0bCkge1xuICAgICAgICB3cmFwcGVkRGF0YS5fX2V4cGlyZXMgPSBEYXRlLm5vdygpICsgb3B0aW9ucy50dGw7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHNlcmlhbGl6ZWREYXRhID0gSlNPTi5zdHJpbmdpZnkod3JhcHBlZERhdGEpO1xuXG4gICAgICAvLyDmqqLmn6XlpKflsI/pmZDliLYgKExvY2FsU3RvcmFnZSDpgJrluLjpmZDliLbngrogNS0xME1CKVxuICAgICAgaWYgKHNlcmlhbGl6ZWREYXRhLmxlbmd0aCA+IDUgKiAxMDI0ICogMTAyNCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ+izh+aWmemBjuWkp++8jOi2heWHuiBMb2NhbFN0b3JhZ2Ug6ZmQ5Yi2Jyk7XG4gICAgICB9XG5cbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGZ1bGxLZXksIHNlcmlhbGl6ZWREYXRhKTtcbiAgICAgIHRoaXMubG9nKGDwn5K+IExvY2FsU3RvcmFnZSDlhLLlrZg6ICR7a2V5fSAoJHt0aGlzLmZvcm1hdEJ5dGVzKHNlcmlhbGl6ZWREYXRhLmxlbmd0aCl9KWApO1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvci5uYW1lID09PSAnUXVvdGFFeGNlZWRlZEVycm9yJyB8fCBlcnJvci5uYW1lID09PSAnTlNfRVJST1JfRE9NX1FVT1RBX1JFQUNIRUQnKSB7XG4gICAgICAgIC8vIOmFjemhjei2heWHuu+8jOWYl+ippua4heeQhuiIiuizh+aWmVxuICAgICAgICBhd2FpdCB0aGlzLmNsZWFudXBPbGREYXRhKCk7XG5cbiAgICAgICAgLy8g5YaN5qyh5ZiX6Kmm5YSy5a2YXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgZnVsbEtleSA9IHRoaXMuZ2V0RnVsbEtleShrZXkpO1xuICAgICAgICAgIGNvbnN0IHdyYXBwZWREYXRhID0geyB2YWx1ZSwgX190aW1lc3RhbXA6IERhdGUubm93KCkgfTtcbiAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShmdWxsS2V5LCBKU09OLnN0cmluZ2lmeSh3cmFwcGVkRGF0YSkpO1xuICAgICAgICAgIHRoaXMubG9nKGDwn5K+IExvY2FsU3RvcmFnZSDlhLLlrZggKOa4heeQhuW+jCk6ICR7a2V5fWApO1xuICAgICAgICB9IGNhdGNoIChyZXRyeUVycm9yKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBMb2NhbFN0b3JhZ2Ug6YWN6aGN5bey5ru/5LiU5riF55CG5b6M5LuN54Sh5rOV5YSy5a2YOiAke3JldHJ5RXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOiugOWPluizh+aWmVxuICAgKi9cbiAgYXN5bmMgZ2V0SXRlbShrZXkpIHtcbiAgICBpZiAoIXRoaXMuaXNBdmFpbGFibGUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTG9jYWxTdG9yYWdlIOS4jeWPr+eUqCcpO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBmdWxsS2V5ID0gdGhpcy5nZXRGdWxsS2V5KGtleSk7XG4gICAgICBjb25zdCBzZXJpYWxpemVkRGF0YSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGZ1bGxLZXkpO1xuXG4gICAgICBpZiAoc2VyaWFsaXplZERhdGEgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHdyYXBwZWREYXRhID0gSlNPTi5wYXJzZShzZXJpYWxpemVkRGF0YSk7XG5cbiAgICAgIC8vIOaqouafpeaYr+WQpumBjuacn1xuICAgICAgaWYgKHdyYXBwZWREYXRhLl9fZXhwaXJlcyAmJiBEYXRlLm5vdygpID4gd3JhcHBlZERhdGEuX19leHBpcmVzKSB7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGZ1bGxLZXkpO1xuICAgICAgICB0aGlzLmxvZyhg4o+wIOizh+aWmeW3sumBjuacn+S4puenu+mZpDogJHtrZXl9YCk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuXG4gICAgICAvLyDnm7jlrrnmgKfomZXnkIbvvJrlpoLmnpzmspLmnInljIXoo53ntZDmp4vvvIznm7TmjqXov5Tlm57ljp/lp4vos4fmlplcbiAgICAgIGlmICh3cmFwcGVkRGF0YS5oYXNPd25Qcm9wZXJ0eSgndmFsdWUnKSkge1xuICAgICAgICB0aGlzLmxvZyhg8J+TliBMb2NhbFN0b3JhZ2Ug6K6A5Y+WOiAke2tleX1gKTtcbiAgICAgICAgcmV0dXJuIHdyYXBwZWREYXRhLnZhbHVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8g6IiK5qC85byP6LOH5paZXG4gICAgICAgIHRoaXMubG9nKGDwn5OWIExvY2FsU3RvcmFnZSDoroDlj5YgKOiIiuagvOW8jyk6ICR7a2V5fWApO1xuICAgICAgICByZXR1cm4gd3JhcHBlZERhdGE7XG4gICAgICB9XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihg4p2MIExvY2FsU3RvcmFnZSDoroDlj5blpLHmlZcgJHtrZXl9OmAsIGVycm9yKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDnp7vpmaTos4fmlplcbiAgICovXG4gIGFzeW5jIHJlbW92ZUl0ZW0oa2V5KSB7XG4gICAgaWYgKCF0aGlzLmlzQXZhaWxhYmxlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0xvY2FsU3RvcmFnZSDkuI3lj6/nlKgnKTtcbiAgICB9XG5cbiAgICBjb25zdCBmdWxsS2V5ID0gdGhpcy5nZXRGdWxsS2V5KGtleSk7XG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oZnVsbEtleSk7XG4gICAgdGhpcy5sb2coYPCfl5HvuI8gTG9jYWxTdG9yYWdlIOenu+mZpDogJHtrZXl9YCk7XG4gIH1cblxuICAvKipcbiAgICog5riF56m65omA5pyJ6LOH5paZXG4gICAqL1xuICBhc3luYyBjbGVhcigpIHtcbiAgICBpZiAoIXRoaXMuaXNBdmFpbGFibGUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTG9jYWxTdG9yYWdlIOS4jeWPr+eUqCcpO1xuICAgIH1cblxuICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhsb2NhbFN0b3JhZ2UpO1xuICAgIGNvbnN0IHByZWZpeGVkS2V5cyA9IGtleXMuZmlsdGVyKGtleSA9PiBrZXkuc3RhcnRzV2l0aCh0aGlzLnByZWZpeCkpO1xuXG4gICAgZm9yIChjb25zdCBrZXkgb2YgcHJlZml4ZWRLZXlzKSB7XG4gICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO1xuICAgIH1cblxuICAgIHRoaXMubG9nKGDwn6e5IExvY2FsU3RvcmFnZSDmuIXnqbo6ICR7cHJlZml4ZWRLZXlzLmxlbmd0aH0g6aCF55uuYCk7XG4gIH1cblxuICAvKipcbiAgICog542y5Y+W5omA5pyJ6Y215ZCNXG4gICAqL1xuICBhc3luYyBrZXlzKCkge1xuICAgIGlmICghdGhpcy5pc0F2YWlsYWJsZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdMb2NhbFN0b3JhZ2Ug5LiN5Y+v55SoJyk7XG4gICAgfVxuXG4gICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKGxvY2FsU3RvcmFnZSk7XG4gICAgcmV0dXJuIGtleXNcbiAgICAgIC5maWx0ZXIoa2V5ID0+IGtleS5zdGFydHNXaXRoKHRoaXMucHJlZml4KSlcbiAgICAgIC5tYXAoa2V5ID0+IGtleS5zdWJzdHJpbmcodGhpcy5wcmVmaXgubGVuZ3RoKSk7XG4gIH1cblxuICAvKipcbiAgICog542y5Y+W5YSy5a2Y6aCF55uu5pW46YePXG4gICAqL1xuICBhc3luYyBzaXplKCkge1xuICAgIGNvbnN0IGtleXMgPSBhd2FpdCB0aGlzLmtleXMoKTtcbiAgICByZXR1cm4ga2V5cy5sZW5ndGg7XG4gIH1cblxuICAvKipcbiAgICog5riF55CG6IiK6LOH5paZICjnlbbphY3poY3kuI3otrPmmYIpXG4gICAqL1xuICBhc3luYyBjbGVhbnVwT2xkRGF0YSgpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKGxvY2FsU3RvcmFnZSk7XG4gICAgICBjb25zdCBwcmVmaXhlZEtleXMgPSBrZXlzLmZpbHRlcihrZXkgPT4ga2V5LnN0YXJ0c1dpdGgodGhpcy5wcmVmaXgpKTtcblxuICAgICAgLy8g542y5Y+W5omA5pyJ6LOH5paZ55qE5pmC6ZaT5oiz6KiYXG4gICAgICBjb25zdCBkYXRhV2l0aFRpbWVzdGFtcCA9IFtdO1xuXG4gICAgICBmb3IgKGNvbnN0IGtleSBvZiBwcmVmaXhlZEtleXMpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpKTtcbiAgICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBkYXRhLl9fdGltZXN0YW1wIHx8IDA7XG4gICAgICAgICAgZGF0YVdpdGhUaW1lc3RhbXAucHVzaCh7IGtleSwgdGltZXN0YW1wIH0pO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgLy8g54Sh5rOV6Kej5p6Q55qE6LOH5paZ6KaW54K65pyA6IiKXG4gICAgICAgICAgZGF0YVdpdGhUaW1lc3RhbXAucHVzaCh7IGtleSwgdGltZXN0YW1wOiAwIH0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIOaMieaZgumWk+aIs+iomOaOkuW6j++8jOenu+mZpOacgOiIiueahCAyNSUg6LOH5paZXG4gICAgICBkYXRhV2l0aFRpbWVzdGFtcC5zb3J0KChhLCBiKSA9PiBhLnRpbWVzdGFtcCAtIGIudGltZXN0YW1wKTtcbiAgICAgIGNvbnN0IGl0ZW1zVG9SZW1vdmUgPSBNYXRoLmNlaWwoZGF0YVdpdGhUaW1lc3RhbXAubGVuZ3RoICogMC4yNSk7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXNUb1JlbW92ZTsgaSsrKSB7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGRhdGFXaXRoVGltZXN0YW1wW2ldLmtleSk7XG4gICAgICAgIHRoaXMubG9nKGDwn6e5IOa4heeQhuiIiuizh+aWmTogJHtkYXRhV2l0aFRpbWVzdGFtcFtpXS5rZXl9YCk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMubG9nKGDwn6e5IOa4heeQhuWujOaIkO+8jOenu+mZpCAke2l0ZW1zVG9SZW1vdmV9IOmgheiIiuizh+aWmWApO1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMubG9nKCfimqDvuI8g5riF55CG6IiK6LOH5paZ5pmC55m855Sf6Yyv6KqkOicsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5qC85byP5YyW5L2N5YWD57WE5aSn5bCPXG4gICAqL1xuICBmb3JtYXRCeXRlcyhieXRlcykge1xuICAgIGlmIChieXRlcyA9PT0gMCkge3JldHVybiAnMCBCeXRlcyc7fVxuICAgIGNvbnN0IGsgPSAxMDI0O1xuICAgIGNvbnN0IHNpemVzID0gWydCeXRlcycsICdLQicsICdNQiddO1xuICAgIGNvbnN0IGkgPSBNYXRoLmZsb29yKE1hdGgubG9nKGJ5dGVzKSAvIE1hdGgubG9nKGspKTtcbiAgICByZXR1cm4gYCR7cGFyc2VGbG9hdCgoYnl0ZXMgLyBNYXRoLnBvdyhrLCBpKSkudG9GaXhlZCgyKSl9ICR7c2l6ZXNbaV19YDtcbiAgfVxuXG4gIC8qKlxuICAgKiDoqr/oqabml6XoqoxcbiAgICovXG4gIGxvZyguLi5hcmdzKSB7XG4gICAgaWYgKHRoaXMuY29uZmlnLmRlYnVnKSB7XG4gICAgICBjb25zb2xlLmxvZygn8J+TnSBMb2NhbFN0b3JhZ2VBZGFwdGVyOicsIC4uLmFyZ3MpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDnjbLlj5bkvb/nlKjntbHoqIhcbiAgICovXG4gIGFzeW5jIGdldFN0YXRzKCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBrZXlzID0gYXdhaXQgdGhpcy5rZXlzKCk7XG4gICAgICBsZXQgdG90YWxTaXplID0gMDtcblxuICAgICAgZm9yIChjb25zdCBrZXkgb2Yga2V5cykge1xuICAgICAgICBjb25zdCBmdWxsS2V5ID0gdGhpcy5nZXRGdWxsS2V5KGtleSk7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShmdWxsS2V5KTtcbiAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICB0b3RhbFNpemUgKz0gZGF0YS5sZW5ndGggKiAyOyAvLyBVVEYtMTYg5a2X56ym5L2UIDIg5L2N5YWD57WEXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaXRlbUNvdW50OiBrZXlzLmxlbmd0aCxcbiAgICAgICAgdG90YWxTaXplLFxuICAgICAgICBmb3JtYXR0ZWRTaXplOiB0aGlzLmZvcm1hdEJ5dGVzKHRvdGFsU2l6ZSksXG4gICAgICAgIG1heFNpemU6IDUgKiAxMDI0ICogMTAyNCwgLy8gNU1CIOS8sOioiOWAvFxuICAgICAgICB1c2FnZVBlcmNlbnRhZ2U6ICh0b3RhbFNpemUgLyAoNSAqIDEwMjQgKiAxMDI0KSkgKiAxMDAsXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLmxvZygn4pqg77iPIOeNsuWPlue1seioiOizh+ioiuaZgueZvOeUn+mMr+iqpDonLCBlcnJvcik7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFTyxNQUFNQSxtQkFBbUIsQ0FBQztFQUMvQkMsV0FBV0EsQ0FBQ0MsTUFBTSxHQUFHLENBQUMsQ0FBQyxFQUFFO0lBQ3ZCLElBQUksQ0FBQ0EsTUFBTSxHQUFHQSxNQUFNO0lBQ3BCLElBQUksQ0FBQ0MsTUFBTSxHQUFHRCxNQUFNLENBQUNFLE1BQU0sR0FBRyxHQUFHRixNQUFNLENBQUNFLE1BQU0sR0FBRyxHQUFHLGNBQWM7SUFDbEUsSUFBSSxDQUFDQyxXQUFXLEdBQUcsSUFBSSxDQUFDQyxpQkFBaUIsQ0FBQyxDQUFDO0VBQzdDOztFQUVBO0FBQ0Y7QUFDQTtFQUNFQSxpQkFBaUJBLENBQUEsRUFBRztJQUNsQixJQUFJO01BQ0YsTUFBTUMsT0FBTyxHQUFHLGtCQUFrQjtNQUNsQ0MsWUFBWSxDQUFDQyxPQUFPLENBQUNGLE9BQU8sRUFBRSxNQUFNLENBQUM7TUFDckNDLFlBQVksQ0FBQ0UsVUFBVSxDQUFDSCxPQUFPLENBQUM7TUFDaEMsT0FBTyxJQUFJO0lBQ2IsQ0FBQyxDQUFDLE9BQU9JLENBQUMsRUFBRTtNQUNWQyxPQUFPLENBQUNDLElBQUksQ0FBQyxzQkFBc0IsRUFBRUYsQ0FBQyxDQUFDO01BQ3ZDLE9BQU8sS0FBSztJQUNkO0VBQ0Y7O0VBRUE7QUFDRjtBQUNBO0VBQ0UsTUFBTUcsSUFBSUEsQ0FBQSxFQUFHO0lBQ1gsSUFBSSxDQUFDLElBQUksQ0FBQ1QsV0FBVyxFQUFFO01BQ3JCLE1BQU0sSUFBSVUsS0FBSyxDQUFDLGtCQUFrQixDQUFDO0lBQ3JDOztJQUVBO0lBQ0EsTUFBTSxJQUFJLENBQUNDLGtCQUFrQixDQUFDLENBQUM7SUFFL0IsSUFBSSxDQUFDQyxHQUFHLENBQUMseUJBQXlCLENBQUM7RUFDckM7O0VBRUE7QUFDRjtBQUNBO0VBQ0UsTUFBTUQsa0JBQWtCQSxDQUFBLEVBQUc7SUFDekIsSUFBSTtNQUNGLE1BQU1FLElBQUksR0FBR0MsTUFBTSxDQUFDRCxJQUFJLENBQUNWLFlBQVksQ0FBQztNQUN0QyxNQUFNWSxZQUFZLEdBQUdGLElBQUksQ0FBQ0csTUFBTSxDQUFDQyxHQUFHLElBQUlBLEdBQUcsQ0FBQ0MsVUFBVSxDQUFDLElBQUksQ0FBQ3BCLE1BQU0sQ0FBQyxDQUFDO01BRXBFLEtBQUssTUFBTW1CLEdBQUcsSUFBSUYsWUFBWSxFQUFFO1FBQzlCLElBQUk7VUFDRixNQUFNSSxJQUFJLEdBQUdDLElBQUksQ0FBQ0MsS0FBSyxDQUFDbEIsWUFBWSxDQUFDbUIsT0FBTyxDQUFDTCxHQUFHLENBQUMsQ0FBQzs7VUFFbEQ7VUFDQSxJQUFJRSxJQUFJLElBQUlBLElBQUksQ0FBQ0ksU0FBUyxJQUFJQyxJQUFJLENBQUNDLEdBQUcsQ0FBQyxDQUFDLEdBQUdOLElBQUksQ0FBQ0ksU0FBUyxFQUFFO1lBQ3pEcEIsWUFBWSxDQUFDRSxVQUFVLENBQUNZLEdBQUcsQ0FBQztZQUM1QixJQUFJLENBQUNMLEdBQUcsQ0FBQyxjQUFjSyxHQUFHLEVBQUUsQ0FBQztVQUMvQjtRQUNGLENBQUMsQ0FBQyxPQUFPUyxVQUFVLEVBQUU7VUFDbkI7VUFDQSxJQUFJLENBQUNkLEdBQUcsQ0FBQyxpQkFBaUJLLEdBQUcsRUFBRSxDQUFDO1FBQ2xDO01BQ0Y7SUFDRixDQUFDLENBQUMsT0FBT1UsS0FBSyxFQUFFO01BQ2QsSUFBSSxDQUFDZixHQUFHLENBQUMsaUJBQWlCLEVBQUVlLEtBQUssQ0FBQztJQUNwQztFQUNGOztFQUVBO0FBQ0Y7QUFDQTtFQUNFQyxVQUFVQSxDQUFDWCxHQUFHLEVBQUU7SUFDZCxPQUFPLEdBQUcsSUFBSSxDQUFDbkIsTUFBTSxHQUFHbUIsR0FBRyxFQUFFO0VBQy9COztFQUVBO0FBQ0Y7QUFDQTtFQUNFLE1BQU1iLE9BQU9BLENBQUNhLEdBQUcsRUFBRVksS0FBSyxFQUFFQyxPQUFPLEdBQUcsQ0FBQyxDQUFDLEVBQUU7SUFDdEMsSUFBSSxDQUFDLElBQUksQ0FBQzlCLFdBQVcsRUFBRTtNQUNyQixNQUFNLElBQUlVLEtBQUssQ0FBQyxrQkFBa0IsQ0FBQztJQUNyQztJQUVBLElBQUk7TUFDRixNQUFNcUIsT0FBTyxHQUFHLElBQUksQ0FBQ0gsVUFBVSxDQUFDWCxHQUFHLENBQUM7O01BRXBDO01BQ0EsTUFBTWUsV0FBVyxHQUFHO1FBQ2xCSCxLQUFLO1FBQ0xJLFdBQVcsRUFBRVQsSUFBSSxDQUFDQyxHQUFHLENBQUMsQ0FBQztRQUN2QlMsU0FBUyxFQUFFLElBQUksQ0FBQ3JDLE1BQU0sQ0FBQ3NDLE9BQU8sSUFBSTtNQUNwQyxDQUFDOztNQUVEO01BQ0EsSUFBSUwsT0FBTyxDQUFDTSxHQUFHLEVBQUU7UUFDZkosV0FBVyxDQUFDVCxTQUFTLEdBQUdDLElBQUksQ0FBQ0MsR0FBRyxDQUFDLENBQUMsR0FBR0ssT0FBTyxDQUFDTSxHQUFHO01BQ2xEO01BRUEsTUFBTUMsY0FBYyxHQUFHakIsSUFBSSxDQUFDa0IsU0FBUyxDQUFDTixXQUFXLENBQUM7O01BRWxEO01BQ0EsSUFBSUssY0FBYyxDQUFDRSxNQUFNLEdBQUcsQ0FBQyxHQUFHLElBQUksR0FBRyxJQUFJLEVBQUU7UUFDM0MsTUFBTSxJQUFJN0IsS0FBSyxDQUFDLHlCQUF5QixDQUFDO01BQzVDO01BRUFQLFlBQVksQ0FBQ0MsT0FBTyxDQUFDMkIsT0FBTyxFQUFFTSxjQUFjLENBQUM7TUFDN0MsSUFBSSxDQUFDekIsR0FBRyxDQUFDLHVCQUF1QkssR0FBRyxLQUFLLElBQUksQ0FBQ3VCLFdBQVcsQ0FBQ0gsY0FBYyxDQUFDRSxNQUFNLENBQUMsR0FBRyxDQUFDO0lBRXJGLENBQUMsQ0FBQyxPQUFPWixLQUFLLEVBQUU7TUFDZCxJQUFJQSxLQUFLLENBQUNjLElBQUksS0FBSyxvQkFBb0IsSUFBSWQsS0FBSyxDQUFDYyxJQUFJLEtBQUssNEJBQTRCLEVBQUU7UUFDdEY7UUFDQSxNQUFNLElBQUksQ0FBQ0MsY0FBYyxDQUFDLENBQUM7O1FBRTNCO1FBQ0EsSUFBSTtVQUNGLE1BQU1YLE9BQU8sR0FBRyxJQUFJLENBQUNILFVBQVUsQ0FBQ1gsR0FBRyxDQUFDO1VBQ3BDLE1BQU1lLFdBQVcsR0FBRztZQUFFSCxLQUFLO1lBQUVJLFdBQVcsRUFBRVQsSUFBSSxDQUFDQyxHQUFHLENBQUM7VUFBRSxDQUFDO1VBQ3REdEIsWUFBWSxDQUFDQyxPQUFPLENBQUMyQixPQUFPLEVBQUVYLElBQUksQ0FBQ2tCLFNBQVMsQ0FBQ04sV0FBVyxDQUFDLENBQUM7VUFDMUQsSUFBSSxDQUFDcEIsR0FBRyxDQUFDLDZCQUE2QkssR0FBRyxFQUFFLENBQUM7UUFDOUMsQ0FBQyxDQUFDLE9BQU8wQixVQUFVLEVBQUU7VUFDbkIsTUFBTSxJQUFJakMsS0FBSyxDQUFDLCtCQUErQmlDLFVBQVUsQ0FBQ0MsT0FBTyxFQUFFLENBQUM7UUFDdEU7TUFDRixDQUFDLE1BQU07UUFDTCxNQUFNakIsS0FBSztNQUNiO0lBQ0Y7RUFDRjs7RUFFQTtBQUNGO0FBQ0E7RUFDRSxNQUFNTCxPQUFPQSxDQUFDTCxHQUFHLEVBQUU7SUFDakIsSUFBSSxDQUFDLElBQUksQ0FBQ2pCLFdBQVcsRUFBRTtNQUNyQixNQUFNLElBQUlVLEtBQUssQ0FBQyxrQkFBa0IsQ0FBQztJQUNyQztJQUVBLElBQUk7TUFDRixNQUFNcUIsT0FBTyxHQUFHLElBQUksQ0FBQ0gsVUFBVSxDQUFDWCxHQUFHLENBQUM7TUFDcEMsTUFBTW9CLGNBQWMsR0FBR2xDLFlBQVksQ0FBQ21CLE9BQU8sQ0FBQ1MsT0FBTyxDQUFDO01BRXBELElBQUlNLGNBQWMsS0FBSyxJQUFJLEVBQUU7UUFDM0IsT0FBTyxJQUFJO01BQ2I7TUFFQSxNQUFNTCxXQUFXLEdBQUdaLElBQUksQ0FBQ0MsS0FBSyxDQUFDZ0IsY0FBYyxDQUFDOztNQUU5QztNQUNBLElBQUlMLFdBQVcsQ0FBQ1QsU0FBUyxJQUFJQyxJQUFJLENBQUNDLEdBQUcsQ0FBQyxDQUFDLEdBQUdPLFdBQVcsQ0FBQ1QsU0FBUyxFQUFFO1FBQy9EcEIsWUFBWSxDQUFDRSxVQUFVLENBQUMwQixPQUFPLENBQUM7UUFDaEMsSUFBSSxDQUFDbkIsR0FBRyxDQUFDLGVBQWVLLEdBQUcsRUFBRSxDQUFDO1FBQzlCLE9BQU8sSUFBSTtNQUNiOztNQUVBO01BQ0EsSUFBSWUsV0FBVyxDQUFDYSxjQUFjLENBQUMsT0FBTyxDQUFDLEVBQUU7UUFDdkMsSUFBSSxDQUFDakMsR0FBRyxDQUFDLHVCQUF1QkssR0FBRyxFQUFFLENBQUM7UUFDdEMsT0FBT2UsV0FBVyxDQUFDSCxLQUFLO01BQzFCLENBQUMsTUFBTTtRQUNMO1FBQ0EsSUFBSSxDQUFDakIsR0FBRyxDQUFDLDZCQUE2QkssR0FBRyxFQUFFLENBQUM7UUFDNUMsT0FBT2UsV0FBVztNQUNwQjtJQUVGLENBQUMsQ0FBQyxPQUFPTCxLQUFLLEVBQUU7TUFDZHBCLE9BQU8sQ0FBQ29CLEtBQUssQ0FBQyx1QkFBdUJWLEdBQUcsR0FBRyxFQUFFVSxLQUFLLENBQUM7TUFDbkQsT0FBTyxJQUFJO0lBQ2I7RUFDRjs7RUFFQTtBQUNGO0FBQ0E7RUFDRSxNQUFNdEIsVUFBVUEsQ0FBQ1ksR0FBRyxFQUFFO0lBQ3BCLElBQUksQ0FBQyxJQUFJLENBQUNqQixXQUFXLEVBQUU7TUFDckIsTUFBTSxJQUFJVSxLQUFLLENBQUMsa0JBQWtCLENBQUM7SUFDckM7SUFFQSxNQUFNcUIsT0FBTyxHQUFHLElBQUksQ0FBQ0gsVUFBVSxDQUFDWCxHQUFHLENBQUM7SUFDcENkLFlBQVksQ0FBQ0UsVUFBVSxDQUFDMEIsT0FBTyxDQUFDO0lBQ2hDLElBQUksQ0FBQ25CLEdBQUcsQ0FBQyx3QkFBd0JLLEdBQUcsRUFBRSxDQUFDO0VBQ3pDOztFQUVBO0FBQ0Y7QUFDQTtFQUNFLE1BQU02QixLQUFLQSxDQUFBLEVBQUc7SUFDWixJQUFJLENBQUMsSUFBSSxDQUFDOUMsV0FBVyxFQUFFO01BQ3JCLE1BQU0sSUFBSVUsS0FBSyxDQUFDLGtCQUFrQixDQUFDO0lBQ3JDO0lBRUEsTUFBTUcsSUFBSSxHQUFHQyxNQUFNLENBQUNELElBQUksQ0FBQ1YsWUFBWSxDQUFDO0lBQ3RDLE1BQU1ZLFlBQVksR0FBR0YsSUFBSSxDQUFDRyxNQUFNLENBQUNDLEdBQUcsSUFBSUEsR0FBRyxDQUFDQyxVQUFVLENBQUMsSUFBSSxDQUFDcEIsTUFBTSxDQUFDLENBQUM7SUFFcEUsS0FBSyxNQUFNbUIsR0FBRyxJQUFJRixZQUFZLEVBQUU7TUFDOUJaLFlBQVksQ0FBQ0UsVUFBVSxDQUFDWSxHQUFHLENBQUM7SUFDOUI7SUFFQSxJQUFJLENBQUNMLEdBQUcsQ0FBQyx1QkFBdUJHLFlBQVksQ0FBQ3dCLE1BQU0sS0FBSyxDQUFDO0VBQzNEOztFQUVBO0FBQ0Y7QUFDQTtFQUNFLE1BQU0xQixJQUFJQSxDQUFBLEVBQUc7SUFDWCxJQUFJLENBQUMsSUFBSSxDQUFDYixXQUFXLEVBQUU7TUFDckIsTUFBTSxJQUFJVSxLQUFLLENBQUMsa0JBQWtCLENBQUM7SUFDckM7SUFFQSxNQUFNRyxJQUFJLEdBQUdDLE1BQU0sQ0FBQ0QsSUFBSSxDQUFDVixZQUFZLENBQUM7SUFDdEMsT0FBT1UsSUFBSSxDQUNSRyxNQUFNLENBQUNDLEdBQUcsSUFBSUEsR0FBRyxDQUFDQyxVQUFVLENBQUMsSUFBSSxDQUFDcEIsTUFBTSxDQUFDLENBQUMsQ0FDMUNpRCxHQUFHLENBQUM5QixHQUFHLElBQUlBLEdBQUcsQ0FBQytCLFNBQVMsQ0FBQyxJQUFJLENBQUNsRCxNQUFNLENBQUN5QyxNQUFNLENBQUMsQ0FBQztFQUNsRDs7RUFFQTtBQUNGO0FBQ0E7RUFDRSxNQUFNVSxJQUFJQSxDQUFBLEVBQUc7SUFDWCxNQUFNcEMsSUFBSSxHQUFHLE1BQU0sSUFBSSxDQUFDQSxJQUFJLENBQUMsQ0FBQztJQUM5QixPQUFPQSxJQUFJLENBQUMwQixNQUFNO0VBQ3BCOztFQUVBO0FBQ0Y7QUFDQTtFQUNFLE1BQU1HLGNBQWNBLENBQUEsRUFBRztJQUNyQixJQUFJO01BQ0YsTUFBTTdCLElBQUksR0FBR0MsTUFBTSxDQUFDRCxJQUFJLENBQUNWLFlBQVksQ0FBQztNQUN0QyxNQUFNWSxZQUFZLEdBQUdGLElBQUksQ0FBQ0csTUFBTSxDQUFDQyxHQUFHLElBQUlBLEdBQUcsQ0FBQ0MsVUFBVSxDQUFDLElBQUksQ0FBQ3BCLE1BQU0sQ0FBQyxDQUFDOztNQUVwRTtNQUNBLE1BQU1vRCxpQkFBaUIsR0FBRyxFQUFFO01BRTVCLEtBQUssTUFBTWpDLEdBQUcsSUFBSUYsWUFBWSxFQUFFO1FBQzlCLElBQUk7VUFDRixNQUFNSSxJQUFJLEdBQUdDLElBQUksQ0FBQ0MsS0FBSyxDQUFDbEIsWUFBWSxDQUFDbUIsT0FBTyxDQUFDTCxHQUFHLENBQUMsQ0FBQztVQUNsRCxNQUFNa0MsU0FBUyxHQUFHaEMsSUFBSSxDQUFDYyxXQUFXLElBQUksQ0FBQztVQUN2Q2lCLGlCQUFpQixDQUFDRSxJQUFJLENBQUM7WUFBRW5DLEdBQUc7WUFBRWtDO1VBQVUsQ0FBQyxDQUFDO1FBQzVDLENBQUMsQ0FBQyxPQUFPN0MsQ0FBQyxFQUFFO1VBQ1Y7VUFDQTRDLGlCQUFpQixDQUFDRSxJQUFJLENBQUM7WUFBRW5DLEdBQUc7WUFBRWtDLFNBQVMsRUFBRTtVQUFFLENBQUMsQ0FBQztRQUMvQztNQUNGOztNQUVBO01BQ0FELGlCQUFpQixDQUFDRyxJQUFJLENBQUMsQ0FBQ0MsQ0FBQyxFQUFFQyxDQUFDLEtBQUtELENBQUMsQ0FBQ0gsU0FBUyxHQUFHSSxDQUFDLENBQUNKLFNBQVMsQ0FBQztNQUMzRCxNQUFNSyxhQUFhLEdBQUdDLElBQUksQ0FBQ0MsSUFBSSxDQUFDUixpQkFBaUIsQ0FBQ1gsTUFBTSxHQUFHLElBQUksQ0FBQztNQUVoRSxLQUFLLElBQUlvQixDQUFDLEdBQUcsQ0FBQyxFQUFFQSxDQUFDLEdBQUdILGFBQWEsRUFBRUcsQ0FBQyxFQUFFLEVBQUU7UUFDdEN4RCxZQUFZLENBQUNFLFVBQVUsQ0FBQzZDLGlCQUFpQixDQUFDUyxDQUFDLENBQUMsQ0FBQzFDLEdBQUcsQ0FBQztRQUNqRCxJQUFJLENBQUNMLEdBQUcsQ0FBQyxhQUFhc0MsaUJBQWlCLENBQUNTLENBQUMsQ0FBQyxDQUFDMUMsR0FBRyxFQUFFLENBQUM7TUFDbkQ7TUFFQSxJQUFJLENBQUNMLEdBQUcsQ0FBQyxjQUFjNEMsYUFBYSxPQUFPLENBQUM7SUFFOUMsQ0FBQyxDQUFDLE9BQU83QixLQUFLLEVBQUU7TUFDZCxJQUFJLENBQUNmLEdBQUcsQ0FBQyxnQkFBZ0IsRUFBRWUsS0FBSyxDQUFDO0lBQ25DO0VBQ0Y7O0VBRUE7QUFDRjtBQUNBO0VBQ0VhLFdBQVdBLENBQUNvQixLQUFLLEVBQUU7SUFDakIsSUFBSUEsS0FBSyxLQUFLLENBQUMsRUFBRTtNQUFDLE9BQU8sU0FBUztJQUFDO0lBQ25DLE1BQU1DLENBQUMsR0FBRyxJQUFJO0lBQ2QsTUFBTUMsS0FBSyxHQUFHLENBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7SUFDbkMsTUFBTUgsQ0FBQyxHQUFHRixJQUFJLENBQUNNLEtBQUssQ0FBQ04sSUFBSSxDQUFDN0MsR0FBRyxDQUFDZ0QsS0FBSyxDQUFDLEdBQUdILElBQUksQ0FBQzdDLEdBQUcsQ0FBQ2lELENBQUMsQ0FBQyxDQUFDO0lBQ25ELE9BQU8sR0FBR0csVUFBVSxDQUFDLENBQUNKLEtBQUssR0FBR0gsSUFBSSxDQUFDUSxHQUFHLENBQUNKLENBQUMsRUFBRUYsQ0FBQyxDQUFDLEVBQUVPLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJSixLQUFLLENBQUNILENBQUMsQ0FBQyxFQUFFO0VBQ3pFOztFQUVBO0FBQ0Y7QUFDQTtFQUNFL0MsR0FBR0EsQ0FBQyxHQUFHdUQsSUFBSSxFQUFFO0lBQ1gsSUFBSSxJQUFJLENBQUN0RSxNQUFNLENBQUN1RSxLQUFLLEVBQUU7TUFDckI3RCxPQUFPLENBQUNLLEdBQUcsQ0FBQyx5QkFBeUIsRUFBRSxHQUFHdUQsSUFBSSxDQUFDO0lBQ2pEO0VBQ0Y7O0VBRUE7QUFDRjtBQUNBO0VBQ0UsTUFBTUUsUUFBUUEsQ0FBQSxFQUFHO0lBQ2YsSUFBSTtNQUNGLE1BQU14RCxJQUFJLEdBQUcsTUFBTSxJQUFJLENBQUNBLElBQUksQ0FBQyxDQUFDO01BQzlCLElBQUl5RCxTQUFTLEdBQUcsQ0FBQztNQUVqQixLQUFLLE1BQU1yRCxHQUFHLElBQUlKLElBQUksRUFBRTtRQUN0QixNQUFNa0IsT0FBTyxHQUFHLElBQUksQ0FBQ0gsVUFBVSxDQUFDWCxHQUFHLENBQUM7UUFDcEMsTUFBTUUsSUFBSSxHQUFHaEIsWUFBWSxDQUFDbUIsT0FBTyxDQUFDUyxPQUFPLENBQUM7UUFDMUMsSUFBSVosSUFBSSxFQUFFO1VBQ1JtRCxTQUFTLElBQUluRCxJQUFJLENBQUNvQixNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDaEM7TUFDRjtNQUVBLE9BQU87UUFDTGdDLFNBQVMsRUFBRTFELElBQUksQ0FBQzBCLE1BQU07UUFDdEIrQixTQUFTO1FBQ1RFLGFBQWEsRUFBRSxJQUFJLENBQUNoQyxXQUFXLENBQUM4QixTQUFTLENBQUM7UUFDMUNHLE9BQU8sRUFBRSxDQUFDLEdBQUcsSUFBSSxHQUFHLElBQUk7UUFBRTtRQUMxQkMsZUFBZSxFQUFHSixTQUFTLElBQUksQ0FBQyxHQUFHLElBQUksR0FBRyxJQUFJLENBQUMsR0FBSTtNQUNyRCxDQUFDO0lBQ0gsQ0FBQyxDQUFDLE9BQU8zQyxLQUFLLEVBQUU7TUFDZCxJQUFJLENBQUNmLEdBQUcsQ0FBQyxpQkFBaUIsRUFBRWUsS0FBSyxDQUFDO01BQ2xDLE9BQU8sSUFBSTtJQUNiO0VBQ0Y7QUFDRjtBQUFDZ0QsT0FBQSxDQUFBaEYsbUJBQUEsR0FBQUEsbUJBQUEiLCJpZ25vcmVMaXN0IjpbXX0=